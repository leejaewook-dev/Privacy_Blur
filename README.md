# Privacy Blur

Privacy Blur는 영상 내 인물의 얼굴을 탐지·식별하여  
**등록자와 비등록자를 구분한 뒤 선택적으로 블러(모자이크) 처리하는 프라이버시 보호 시스템**입니다.

본 프로젝트는 단순 얼굴 검출 기반 블러링의 한계를 개선하고,  
특히 **저조도(어두운 환경) 영상에서도 안정적으로 동작하는 얼굴 블러링 파이프라인**을 목표로 합니다.

> 본 저장소는 포트폴리오 목적의 정리본이며,  
> 개인정보 보호를 위해 원본 영상, 얼굴 이미지, 논문 및 발표 자료는 포함하지 않습니다.

---

## Project Overview

- **문제 배경**
  - CCTV, 스트리밍, 영상 공유 환경에서 얼굴 노출은 개인정보 침해로 이어질 수 있음
  - 기존 블러링 방식은
    - 얼굴 인식 실패 시 과도한 모자이크 발생
    - 저조도 환경에서 성능 급격히 저하되는 문제 존재

- **프로젝트 목표**
  - 얼굴 임베딩 기반 식별을 통해 *누구를 가릴지* 판단
  - 환경 조건(밝기)에 따른 실패를 줄이는 강건한 파이프라인 설계
  - 동일 영상 기반 정량 실험이 가능한 구조 구현

---

## Team & My Role

- **팀 구성**
  - 학생 개발자 2명
  - 지도 및 자문 교수 1명

- **담당 역할 (AI / Face Blurring Pipeline)**
  - 얼굴 탐지 및 정렬 파이프라인 구현
  - 얼굴 임베딩 추출 및 등록자 기준 벡터(centroid) 생성
  - 임베딩 유사도 기반 등록자 / 비등록자 판별 로직 설계
  - 선택적 블러링 정책 구현 (등록자 통과 / 비등록자 모자이크)
  - 저조도 환경 대응을 위한 전처리 및 폴백 전략 설계
  - 정량 평가 지표 설계 및 실험 수행

---

## System Pipeline

1. **Input**
   - 영상 파일 또는 실시간 프레임 입력

2. **Person / Face Detection**
   - YOLO 기반 사람 탐지
   - 탐지 영역 내 얼굴 위치 추출

3. **Face Identification**
   - ArcFace 기반 얼굴 임베딩 추출
   - 등록자 기준 임베딩과 cosine similarity 비교
   - 임계값 기반 등록자 / 비등록자 판별

4. **Selective Blurring**
   - 비등록자에 대해서만 얼굴 또는 인물 영역 모자이크 처리

5. **Logging & Evaluation**
   - 프레임/얼굴 크롭 저장
   - 예측 결과 JSON 생성
   - Ground Truth와 비교한 정량 평가

---

## Baseline vs Improved

### Baseline
- 웹캠 기반 실시간 처리 중심
- 원본 프레임에서 바로 탐지·인식 수행
- 얼굴 인식 실패 시 즉시 모자이크 처리
- 저조도 환경에서 오탐 및 과도한 블러링 발생

### Improved
- 영상 파일 기반 처리로 실험 재현성 확보
- 프레임 밝기 사전 분석 후 **저조도에서만 조건부 전처리 적용**
- 단계별 폴백 전략 도입
  - 탐지 실패 시 원본/보정 프레임 재시도
  - 얼굴 인식 실패 시 보정 프레임 기반 재시도
- 전처리 적용 여부에 따른 임계값 분리
- 프레임 단위 예측 JSON 자동 생성 및 정량 평가 구조 개선

---

## Experiments: Face Blurring Performance

본 실험은 **동일한 영상 데이터를 기준으로 수행**되었습니다.  
수동으로 모자이크 처리한 결과를 **Ground Truth**로 설정하고,  
모델 기반 자동 블러링 결과와 비교하여 성능을 평가했습니다.

환경 조건에 따른 강건성을 확인하기 위해 다음 두 가지 조건으로 실험을 분리했습니다.
- **Bright condition** (밝은 환경)
- **Dark condition** (저조도 환경)

---

### Experimental Setup

- 동일한 영상에 대해 수동 모자이크 결과를 정답(GT)으로 사용
- 자동 블러링 결과와 프레임 단위 비교
- 동일 파이프라인을 밝기 조건별로 적용하여 성능 비교

---

### Quantitative Results

| Condition | System   | Accuracy | Precision | Recall | F1-score |
|----------|----------|----------|-----------|--------|----------|
| Bright   | Baseline | 0.790    | 0.837     | 0.612  | 0.707    |
| Bright   | Improved | 0.811    | 0.845     | 0.667  | 0.746    |
| Dark     | Baseline | 0.519    | 0.436     | 0.534  | 0.480    |
| Dark     | Improved | 0.694    | 0.672     | 0.511  | 0.581    |

---

### Analysis

- **Bright condition**
  - 두 시스템 모두 안정적인 성능을 보였으나,
  - Improved 버전이 precision–recall 균형 측면에서 더 높은 F1-score를 기록

- **Dark condition**
  - Baseline은 저조도 환경에서 탐지·인식 실패로 성능 급감
  - Improved 버전은 조건부 전처리와 폴백 전략을 통해
    - Accuracy **+17.5%p**
    - F1-score **+10.1%p**
    성능 향상 달성

**Takeaway**  
> 제안한 개선 파이프라인은 저조도 환경에서 얼굴 블러링의 강건성을 유의미하게 향상시킵니다.

---

## Notes

- 개인정보 보호를 위해 원본 영상 및 얼굴 데이터는 저장소에 포함하지 않습니다.
- 실험 결과는 논문 및 발표 자료로 정리되었으며,
  공동 연구 및 개인정보 이슈로 인해 공개 저장소에는 포함하지 않았습니다.
  (요청 시 별도 제공 가능)
